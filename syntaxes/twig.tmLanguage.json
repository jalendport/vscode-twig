{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "Twig",
	"scopeName": "text.html.twig",
	"injections": {
		"L:text.html.twig meta.tag - (comment.block.twig | meta.embedded.twig)": {
			"patterns": [
				{ "include": "#comment" },
				{ "include": "#output" },
				{ "include": "#execute" }
			]
		}
	},
	"patterns": [
		{ "include": "#comment" },
		{ "include": "#output" },
		{ "include": "#execute" },
		{ "include": "#css-embed" },
		{ "include": "#js-embed" },
		{ "include": "text.html.basic" }
	],
	"repository": {
		"comment": {
			"comment": "Matches Twig comment blocks: {# ... #}",
			"name": "comment.block.twig",
			"begin": "\\{\\#",
			"end": "\\#\\}",
			"patterns": []
		},
		"output": {
			"comment": "Matches Twig output blocks: {{ ... }}",
			"name": "meta.embedded.output.twig",
			"begin": "\\{\\{",
			"end": "\\}\\}",
			"patterns": [
				{ "include": "#filters" },
				{ "include": "#functions" },
				{ "include": "#tests" },
				{ "include": "#expressions" }
			]
		},
		"execute": {
			"comment": "Matches Twig execute blocks: {% ... %}",
			"name": "meta.embedded.execute.twig",
			"begin": "\\{\\%",
			"end": "\\%\\}",
			"patterns": [
				{ "include": "#tags" },
				{ "include": "#filters" },
				{ "include": "#functions" },
				{ "include": "#tests" },
				{ "include": "#expressions" }
			]
		},
		"tags": {
			"comment": "Matches Twig tags",
			"patterns": [
				{
					"name": "keyword.control.twig",
					"match": "\\G\\s*([a-zA-Z_][\\w]*)"
				}
			]
		},
		"filters": {
			"comment": "Matches Twig filters",
			"patterns": [
				{
					"name": "support.function.filters.twig",
					"match": "(?<=\\|)\\s*([a-zA-Z_][\\w]*)|((?<=apply\\s)([a-zA-Z_][\\w]*))"
				}
			]
		},
		"functions": {
			"comment": "Matches Twig functions",
			"patterns": [
				{
					"name": "support.function.functions.twig",
					"match": "\\b([a-zA-Z_][\\w]*)(?=\\()"
				}
			]
		},
		"tests": {
			"comment": "Matches Twig tests",
			"patterns": [
				{
					"name": "support.function.tests.twig",
					"match": "(?<=is\\s)([a-zA-Z_][\\w]*(?:\\s+[a-zA-Z_][\\w]*)*)"
				}
			]
		},
		"expressions": {
			"comment": "Matches Twig expressions (strings, numbers, operators, variables)",
			"patterns": [
				{ "include": "#single-strings" },
				{ "include": "#double-strings" },
				{ "include": "#numbers" },
				{ "include": "#operators" },
				{ "include": "#variables" }
			]
		},
		"single-strings": {
			"comment": "Matches single-quoted strings in Twig",
			"name": "string.quoted.single.twig",
			"begin": "'",
			"end": "'",
			"patterns": [
				{
					"name": "constant.character.escape.twig",
					"match": "\\\\."
				}
			]
		},
		"double-strings": {
			"comment": "Matches double-quoted strings in Twig",
			"name": "string.quoted.double.twig",
			"begin": "\"",
			"end": "\"",
			"patterns": [
				{
					"name": "constant.character.escape.twig",
					"match": "\\\\."
				}
			]
		},
		"numbers": {
			"comment": "Matches numbers in Twig",
			"name": "constant.numeric.twig",
			"match": "\\b\\d+(?:\\.\\d+)?\\b"
		},
		"operators": {
			"comment": "Matches operators in Twig",
			"name": "keyword.operator.twig",
			"match": "\\*\\*|\\/\\/|[+\\-*/%]|\\b(?:and|xor|or|not)\\b|\\=\\=|\\!\\=|\\<\\=|\\>\\=|\\<|\\>|\\<\\=\\>|\\b(?:has every|has some)\\b|\\b(?:in|not in|starts with|ends with|is|is not)\\b|\\||\\.\\.|\\~|\\.|\\?\\:|\\?\\?|\\?|\\:|\\.\\.\\.|\\=\\>"
		},
		"variables": {
			"comment": "Matches variable names in Twig",
			"name": "variable.other.twig",
			"match": "[a-zA-Z_][a-zA-Z0-9_]*"
		}
	}
}
